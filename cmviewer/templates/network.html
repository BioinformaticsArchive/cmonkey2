<script>
      $(document).ready(function() {
        var nodeData = [];
        for (var i = 0; i < {{num_clusters}}; i++) {
          var cluster = i + 1;
          nodeData[i] = { classes: 'clusters', data: { id: cluster.toString(), name: cluster.toString() } };
        };
        var genes = [
          {% for gene in genes %}{ classes: 'genes', data: { id: '{{gene}}', name: '{{gene}}' } },
          {% endfor %}
        ];
        nodeData = nodeData.concat(genes);
        var motifs = [
          {% for motif in motifs %}{ classes: 'motifs', data: { id: 'm{{motif[0]}}', name: '{{motif[1]}}_{{motif[2]}}' } },
          {% endfor %}
        ];
        nodeData = nodeData.concat(motifs);

        var edgeData = [
          {% for gene, cluster in edges %}{ data: { source: '{{gene}}', target: '{{cluster}}' } },
          {% endfor %}
        ];

        var cy = $('#cy').cytoscape({
          style: cytoscape.stylesheet()
            .selector('node').css({
              'content': 'data(name)',
              'text-valign': 'center',
              'color': 'black',
              'min-zoomed-font-size': 7
            })
            .selector('edge').css({
              'target-arrow-shape': 'none',
              'curve-style': 'haystack'
            })
            .selector('.clusters').css({
              'color': 'green', 'background-color': 'red',
              'width': 10, 'height': 10, 'font-size': '8'
            })
            .selector('.genes').css({
              'width': 5, 'height': 5, 'font-size': '3'
            })
            .selector('.motifs').css({
              'width': 5, 'height': 5, 'font-size': '3', 'shape': 'triangle',
              'background-color': 'green'
            })
            .selector(':selected').css({
              'background-color': 'black',
              'line-color': 'black',
            })
            .selector('.faded').css({
              'opacity': 0.25,
              'text-opacity': 0
            }),
          ready: function() {
            var cy = this;
            cy.load({ nodes: nodeData, edges: edgeData}, function() {
              cy.layout({name: 'springy', animate: false, fit: true});
              cy.fit();
            });
            /*
            cy.elements().unselectify();
            cy.on('tap', 'node', function(e) {
              var node = e.cyTarget;
              var neighborhood = node.neighborhood().add(node);
              cy.elements().addClass('faded');
              neighborhood.removeClass('faded');
            });
            cy.on('tap', function(e) {
              if (e.cyTarget === cy) {
                cy.elements().removeClass('faded');
              }
            }); */
          },
          pixelRatio: 1.0,
          motionBlur: true,
          hideEdgesOnViewport: true,
          hideLabelsOnViewport: true,
          textureOnViewport: true
        });
      }); // on dom ready
</script>
<div id="nw-container">
  <div id="cy"></div>
</div>
